

logging {
  
  ### Logging - configure the default log, stderr
  stream {
    name default-log
    filedesc 2
  
    levels:reset info warn error fatal debug
    types:reset default spam
  
    # Limit the rate of spam (potentially very frequent) messages
    limit {
      types spam
      rate 5
      burst 30
    }
  }

}

dnscol_input {
#   uri ring:wlp3s0
   snaplen 1024
   promiscuous 1
   filter "port 53"
   frame_max_duration 1.0
   frame_max_size 4096
}




IGNORED_collector {
  ### Input

  input {
      device wlan0
      snaplen 1024
      promiscuous 1
      filter "port 53"
  }

  input {
      device eth0
      snaplen 1024
      promiscuous 1
      filter "port 53"
  }
  
  ### Processing

  # With offline set, never drop any packet frames queued for output
  #force_offline 0

  # Length of a time frame for request/response matching
  timeframe_length 1.0

  # Size of the hashtable to match requests to responses is 2^order
  hash_order 16

  ### Outputs
  # Possible fields:
  #   flags client_addr client_port server_addr server_port id qname qtype qclass
  #   request_time_us request_flags request_ans_rrs request_auth_rrs request_add_rrs request_length
  #   response_time_us response_flags response_ans_rrs response_auth_rrs response_add_rrs response_length

#  output_proto {
#    path_template "/dev/null"
#    #path_template "../out/matches-%Y%m%d-%H%M%S.pb.lz4"
#    compression none
#    period 300.0
#    fields flags client_addr client_port qname qtype qclass id request_time_us request_flags response_time_us response_flags
#  }

  output_csv {
    path "out/akuma-%Y%m%d-%H%M%S.csv"
    #path "/dev/null"
    compression none
    period 0.0

    #fields flags client_addr client_port qname qtype qclass id request_time_us request_flags response_time_us response_flags

    fields flags client_addr client_port server_addr server_port id qname qtype qclass \
           request_time_us request_flags request_ans_rrs request_auth_rrs request_add_rrs request_length \
           response_time_us response_flags response_ans_rrs response_auth_rrs response_add_rrs response_length

    # All available fields:
    # fields flags client_addr client_port server_addr server_port id qname qtype qclass \
    #        request_time_us request_flags request_ans_rrs request_auth_rrs request_add_rrs request_length \
    #        response_time_us response_flags response_ans_rrs response_auth_rrs response_add_rrs response_length

    debug_packet_delay_us 0

    separator "|"
    header 1
  }

#  output_pcap {
#    #path_template "../out/akuma-%Y%m%d-%H%M%S-dump.pcap"
#    path_template "/dev/null"
#    compression none
#    period 600.0
#    dump_reasons other malformed fragmented protocol direction port bad_dns frame_full no_request
#
#    # rate limiting?
#  }
}
